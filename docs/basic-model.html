<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Basic Model | Time Series Analysis</title>
  <meta name="description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::bs4_book,
set in the _output.yml file.</p>" />
  <meta name="generator" content="bookdown 0.32 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Basic Model | Time Series Analysis" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::bs4_book,
set in the _output.yml file.</p>" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Basic Model | Time Series Analysis" />
  
  <meta name="twitter:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::bs4_book,
set in the _output.yml file.</p>" />
  

<meta name="author" content="shang-chieh0830" />


<meta name="date" content="2023-03-14" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="plotting.html"/>
<link rel="next" href="dependence.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Time Series Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About</a></li>
<li class="chapter" data-level="2" data-path="introduction-to-r.html"><a href="introduction-to-r.html"><i class="fa fa-check"></i><b>2</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#basic-operation"><i class="fa fa-check"></i><b>2.1</b> Basic Operation</a></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#vectors"><i class="fa fa-check"></i><b>2.2</b> Vectors</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#files"><i class="fa fa-check"></i><b>2.3</b> Files</a></li>
<li class="chapter" data-level="2.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#regression"><i class="fa fa-check"></i><b>2.4</b> Regression</a></li>
<li class="chapter" data-level="2.5" data-path="introduction-to-r.html"><a href="introduction-to-r.html#object-oriented-language"><i class="fa fa-check"></i><b>2.5</b> Object-Oriented Language</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="plotting.html"><a href="plotting.html"><i class="fa fa-check"></i><b>3</b> Plotting</a>
<ul>
<li class="chapter" data-level="3.1" data-path="plotting.html"><a href="plotting.html#example-data"><i class="fa fa-check"></i><b>3.1</b> Example Data</a></li>
<li class="chapter" data-level="3.2" data-path="plotting.html"><a href="plotting.html#sp500-index"><i class="fa fa-check"></i><b>3.2</b> S&amp;P500 Index</a></li>
<li class="chapter" data-level="3.3" data-path="plotting.html"><a href="plotting.html#sunspots"><i class="fa fa-check"></i><b>3.3</b> Sunspots</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="plotting.html"><a href="plotting.html#plot.ts"><i class="fa fa-check"></i><b>3.3.1</b> plot.ts()</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="basic-model.html"><a href="basic-model.html"><i class="fa fa-check"></i><b>4</b> Basic Model</a>
<ul>
<li class="chapter" data-level="4.1" data-path="basic-model.html"><a href="basic-model.html#white-noise"><i class="fa fa-check"></i><b>4.1</b> White Noise</a></li>
<li class="chapter" data-level="4.2" data-path="basic-model.html"><a href="basic-model.html#moving-average"><i class="fa fa-check"></i><b>4.2</b> Moving Average</a></li>
<li class="chapter" data-level="4.3" data-path="basic-model.html"><a href="basic-model.html#autoregression"><i class="fa fa-check"></i><b>4.3</b> Autoregression</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="dependence.html"><a href="dependence.html"><i class="fa fa-check"></i><b>5</b> Dependence</a>
<ul>
<li class="chapter" data-level="5.1" data-path="dependence.html"><a href="dependence.html#autocovariance-function"><i class="fa fa-check"></i><b>5.1</b> Autocovariance function</a></li>
<li class="chapter" data-level="5.2" data-path="dependence.html"><a href="dependence.html#autocorrelation-function-acf"><i class="fa fa-check"></i><b>5.2</b> Autocorrelation function (ACF)</a></li>
<li class="chapter" data-level="5.3" data-path="dependence.html"><a href="dependence.html#strong-positive-and-negative-linear-dependence"><i class="fa fa-check"></i><b>5.3</b> Strong positive and negative linear dependence</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="stationarity.html"><a href="stationarity.html"><i class="fa fa-check"></i><b>6</b> Stationarity</a>
<ul>
<li class="chapter" data-level="6.1" data-path="stationarity.html"><a href="stationarity.html#stationarity-1"><i class="fa fa-check"></i><b>6.1</b> Stationarity</a></li>
<li class="chapter" data-level="6.2" data-path="stationarity.html"><a href="stationarity.html#linear-process"><i class="fa fa-check"></i><b>6.2</b> Linear Process</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="estimation-and-inference-for-measures-of-dependence.html"><a href="estimation-and-inference-for-measures-of-dependence.html"><i class="fa fa-check"></i><b>7</b> Estimation and Inference for measures of dependence</a>
<ul>
<li class="chapter" data-level="7.1" data-path="estimation-and-inference-for-measures-of-dependence.html"><a href="estimation-and-inference-for-measures-of-dependence.html#sample-mean-function"><i class="fa fa-check"></i><b>7.1</b> Sample mean function</a></li>
<li class="chapter" data-level="7.2" data-path="estimation-and-inference-for-measures-of-dependence.html"><a href="estimation-and-inference-for-measures-of-dependence.html#sample-autocovariance-function"><i class="fa fa-check"></i><b>7.2</b> Sample autocovariance function</a></li>
<li class="chapter" data-level="7.3" data-path="estimation-and-inference-for-measures-of-dependence.html"><a href="estimation-and-inference-for-measures-of-dependence.html#sample-autocorrelation-function-acf"><i class="fa fa-check"></i><b>7.3</b> Sample autocorrelation function (ACF)</a></li>
<li class="chapter" data-level="7.4" data-path="estimation-and-inference-for-measures-of-dependence.html"><a href="estimation-and-inference-for-measures-of-dependence.html#sampling-distribution"><i class="fa fa-check"></i><b>7.4</b> Sampling distribution</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="resolving-non-stationarity-problems.html"><a href="resolving-non-stationarity-problems.html"><i class="fa fa-check"></i><b>8</b> Resolving Non-Stationarity Problems</a>
<ul>
<li class="chapter" data-level="8.1" data-path="resolving-non-stationarity-problems.html"><a href="resolving-non-stationarity-problems.html#differencing"><i class="fa fa-check"></i><b>8.1</b> Differencing</a></li>
<li class="chapter" data-level="8.2" data-path="resolving-non-stationarity-problems.html"><a href="resolving-non-stationarity-problems.html#backshift-operator"><i class="fa fa-check"></i><b>8.2</b> Backshift Operator</a></li>
<li class="chapter" data-level="8.3" data-path="resolving-non-stationarity-problems.html"><a href="resolving-non-stationarity-problems.html#fractional-differencing"><i class="fa fa-check"></i><b>8.3</b> Fractional Differencing</a></li>
<li class="chapter" data-level="8.4" data-path="resolving-non-stationarity-problems.html"><a href="resolving-non-stationarity-problems.html#transformations"><i class="fa fa-check"></i><b>8.4</b> Transformations</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Time Series Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="basic-model" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Basic Model<a href="basic-model.html#basic-model" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this chapter, we will go introduce some basic <em>Time Series</em> model. Hopefully, we can discuss them in details in the following chapters.</p>
<div class="definition">
<p><span id="def:unlabeled-div-1" class="definition"><strong>Definition 4.1  </strong></span><strong><em>Stochastic process</em></strong></p>
<p><strong><em>Stochastic process</em></strong> is a collection of random variables <span class="math inline">\(\{X_t\}\)</span> indexed by t.</p>
<p><strong><em>Time Series</em></strong> is a collection of random vatiables indexed according to the order they are obtained in time.</p>
<p>A <strong><em>realization</em></strong> of the stochastic process is the observed values.</p>
</div>
<div id="white-noise" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> White Noise<a href="basic-model.html#white-noise" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="example">
<p><span id="exm:unlabeled-div-2" class="example"><strong>Example 4.1  </strong></span><strong><em>White Noise</em></strong></p>
<p><span class="math inline">\(W_t\sim \mathrm{i.i.d.} (0,\sigma^2) , \forall t=1,...,n\)</span></p>
<p>usually, we assume normal distribution, i.e.,</p>
<p><span class="math inline">\(W_t\sim \mathrm{i.i.d.} N(0,\sigma^2) , \forall t=1,...,n\)</span></p>
</div>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="basic-model.html#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">8128</span>)</span>
<span id="cb81-2"><a href="basic-model.html#cb81-2" aria-hidden="true" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb81-3"><a href="basic-model.html#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(w)</span>
<span id="cb81-4"><a href="basic-model.html#cb81-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -0.10528941  0.25548490  0.82065388  0.04070997</span></span>
<span id="cb81-5"><a href="basic-model.html#cb81-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [5] -0.66722880 -1.54502793</span></span></code></pre></div>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="basic-model.html#cb82-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-2"><a href="basic-model.html#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.new</span>(<span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">6</span>, <span class="at">pointsize =</span> <span class="dv">10</span>)</span>
<span id="cb82-3"><a href="basic-model.html#cb82-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-4"><a href="basic-model.html#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="co"># we did not specify y-axis here</span></span>
<span id="cb82-5"><a href="basic-model.html#cb82-5" aria-hidden="true" tabindex="-1"></a><span class="co"># note that we use expression() to type math expression</span></span>
<span id="cb82-6"><a href="basic-model.html#cb82-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> w, <span class="at">ylab =</span> <span class="fu">expression</span>(w[t]), <span class="at">xlab =</span> <span class="st">&quot;t&quot;</span>, type </span>
<span id="cb82-7"><a href="basic-model.html#cb82-7" aria-hidden="true" tabindex="-1"></a>    <span class="ot">=</span> <span class="st">&quot;o&quot;</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;White </span></span>
<span id="cb82-8"><a href="basic-model.html#cb82-8" aria-hidden="true" tabindex="-1"></a><span class="st">    noise where &quot;</span>, w[t], <span class="st">&quot; ~ ind. N(0, 1)&quot;</span>)), </span>
<span id="cb82-9"><a href="basic-model.html#cb82-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.first =</span> <span class="fu">grid</span>(<span class="at">col =</span> <span class="st">&quot;gray&quot;</span>, <span class="at">lty =</span> <span class="st">&quot;dotted&quot;</span>))</span>
<span id="cb82-10"><a href="basic-model.html#cb82-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in title(...): font metrics unknown for character</span></span>
<span id="cb82-11"><a href="basic-model.html#cb82-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0xa</span></span>
<span id="cb82-12"><a href="basic-model.html#cb82-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-13"><a href="basic-model.html#cb82-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in title(...): font metrics unknown for character</span></span>
<span id="cb82-14"><a href="basic-model.html#cb82-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0xa</span></span></code></pre></div>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="basic-model.html#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Advantage of second plot is separate control over color of points</span></span>
<span id="cb83-2"><a href="basic-model.html#cb83-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3"><a href="basic-model.html#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> w, <span class="at">ylab =</span> <span class="fu">expression</span>(w[t]), <span class="at">xlab =</span> <span class="st">&quot;t&quot;</span>, <span class="at">type =</span> </span>
<span id="cb83-4"><a href="basic-model.html#cb83-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;White noise where &quot;</span>, w[t], <span class="st">&quot; ~ ind. N(0, 1)&quot;</span>)), </span>
<span id="cb83-5"><a href="basic-model.html#cb83-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.first =</span> <span class="fu">grid</span>(<span class="at">col =</span> <span class="st">&quot;gray&quot;</span>, <span class="at">lty =</span> <span class="st">&quot;dotted&quot;</span>))</span>
<span id="cb83-6"><a href="basic-model.html#cb83-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-7"><a href="basic-model.html#cb83-7" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x =</span> w, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="03-Basic-Model_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>Suppose another white noise process is simulated. Below is a plot overlaying the two time series.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="basic-model.html#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1298</span>)</span>
<span id="cb84-2"><a href="basic-model.html#cb84-2" aria-hidden="true" tabindex="-1"></a>w.new <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb84-3"><a href="basic-model.html#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(w.new)</span>
<span id="cb84-4"><a href="basic-model.html#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1]  1.08820292 -1.46217413 -1.10887422  0.55156914</span></span>
<span id="cb84-5"><a href="basic-model.html#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [5]  0.70582813  0.05079594</span></span></code></pre></div>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="basic-model.html#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb85-2"><a href="basic-model.html#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> w, </span>
<span id="cb85-3"><a href="basic-model.html#cb85-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="fu">expression</span>(w[t]), <span class="at">xlab =</span> <span class="st">&quot;t&quot;</span>, </span>
<span id="cb85-4"><a href="basic-model.html#cb85-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb85-5"><a href="basic-model.html#cb85-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;White noise where &quot;</span>, w[t], <span class="st">&quot; ~ ind. N(0, 1)&quot;</span>)), </span>
<span id="cb85-6"><a href="basic-model.html#cb85-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">panel.first =</span> <span class="fu">grid</span>(<span class="at">col =</span> <span class="st">&quot;gray&quot;</span>, <span class="at">lty =</span> <span class="st">&quot;dotted&quot;</span>))</span>
<span id="cb85-7"><a href="basic-model.html#cb85-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-8"><a href="basic-model.html#cb85-8" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x =</span> w, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb85-9"><a href="basic-model.html#cb85-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-10"><a href="basic-model.html#cb85-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x =</span> w.new, <span class="at">col =</span> <span class="st">&quot;green&quot;</span>)</span>
<span id="cb85-11"><a href="basic-model.html#cb85-11" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x =</span> w.new, <span class="at">pch =</span> <span class="dv">20</span>,<span class="at">col =</span> <span class="st">&quot;orange&quot;</span>)</span>
<span id="cb85-12"><a href="basic-model.html#cb85-12" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span><span class="st">&quot;top&quot;</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;Time series 1&quot;</span>, <span class="st">&quot;Time series 2&quot;</span>), <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;green&quot;</span>), </span>
<span id="cb85-13"><a href="basic-model.html#cb85-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="03-Basic-Model_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>We could also plot the two time series separately.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="basic-model.html#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.new</span>(<span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">6</span>, <span class="at">pointsize =</span> <span class="dv">10</span>) <span class="co">#Open a new plot window</span></span>
<span id="cb86-2"><a href="basic-model.html#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="co">#make frame by row 2 rows 1 cols</span></span>
<span id="cb86-3"><a href="basic-model.html#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb86-4"><a href="basic-model.html#cb86-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> w, <span class="at">ylab =</span> <span class="fu">expression</span>(w[t]), <span class="at">xlab =</span> <span class="st">&quot;t&quot;</span>, <span class="at">type =</span> </span>
<span id="cb86-5"><a href="basic-model.html#cb86-5" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;White noise where &quot;</span>, w[t], <span class="st">&quot;~N(0, 1)&quot;</span>)), <span class="at">panel.first =</span> </span>
<span id="cb86-6"><a href="basic-model.html#cb86-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grid</span>(<span class="at">col =</span> <span class="st">&quot;gray&quot;</span>, <span class="at">lty =</span> <span class="st">&quot;dotted&quot;</span>))</span>
<span id="cb86-7"><a href="basic-model.html#cb86-7" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x =</span> w, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb86-8"><a href="basic-model.html#cb86-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-9"><a href="basic-model.html#cb86-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-10"><a href="basic-model.html#cb86-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> w.new, <span class="at">ylab =</span> <span class="fu">expression</span>(w.new[t]), <span class="at">xlab =</span> </span>
<span id="cb86-11"><a href="basic-model.html#cb86-11" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;t&quot;</span>, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&quot;green&quot;</span>, <span class="at">main =</span> </span>
<span id="cb86-12"><a href="basic-model.html#cb86-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;White noise where &quot;</span>, w[t], <span class="st">&quot; ~ ind.N(0, 1)&quot;</span>)), <span class="at">panel.first=</span><span class="fu">grid</span>(<span class="at">col =</span> <span class="st">&quot;gray&quot;</span>, <span class="at">lty =</span> </span>
<span id="cb86-13"><a href="basic-model.html#cb86-13" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;dotted&quot;</span>))</span>
<span id="cb86-14"><a href="basic-model.html#cb86-14" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x =</span> w.new, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">&quot;orange&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="basic-model.html#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># What if used plot.ts()?</span></span>
<span id="cb87-2"><a href="basic-model.html#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.new</span>(<span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">6</span>, <span class="at">pointsize =</span> <span class="dv">10</span>) <span class="co">#Open a new plot window</span></span>
<span id="cb87-3"><a href="basic-model.html#cb87-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-4"><a href="basic-model.html#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(<span class="at">x =</span> <span class="fu">cbind</span>(w, w.new), <span class="at">ylab =</span> <span class="fu">expression</span>(w[t]), <span class="at">xlab =</span> <span class="st">&quot;t&quot;</span>, <span class="at">type =</span> <span class="st">&quot;o&quot;</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;White noise where &quot;</span>, w[t], <span class="st">&quot; ~ ind. N(0, 1)&quot;</span>)), <span class="at">panel.first=</span><span class="fu">grid</span>(<span class="at">col =</span> <span class="st">&quot;gray&quot;</span>, <span class="at">lty =</span> <span class="st">&quot;dotted&quot;</span>))</span>
<span id="cb87-5"><a href="basic-model.html#cb87-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-6"><a href="basic-model.html#cb87-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Problem: gridlines do not extend to second plot</span></span>
<span id="cb87-7"><a href="basic-model.html#cb87-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb87-8"><a href="basic-model.html#cb87-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(<span class="at">x =</span> <span class="fu">cbind</span>(w, w.new), <span class="at">ylab =</span> <span class="fu">expression</span>(w[t]), <span class="at">xlab =</span> <span class="st">&quot;t&quot;</span>, <span class="at">type =</span> <span class="st">&quot;o&quot;</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;White noise where &quot;</span>, w[t], <span class="st">&quot; ~ ind. N(0, 1)&quot;</span>)))</span>
<span id="cb87-9"><a href="basic-model.html#cb87-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-10"><a href="basic-model.html#cb87-10" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>(<span class="at">col =</span> <span class="st">&quot;gray&quot;</span>, <span class="at">lty =</span> <span class="st">&quot;dotted&quot;</span>)</span>
<span id="cb87-11"><a href="basic-model.html#cb87-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Problem: gridlines do not appear correctly on plots (could fix by specifying where to draw them using abline)</span></span></code></pre></div>
</div>
<div id="moving-average" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Moving Average<a href="basic-model.html#moving-average" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="example">
<p><span id="exm:unlabeled-div-3" class="example"><strong>Example 4.2  </strong></span><strong><em>Moving Average of White Noise</em></strong></p>
<p>The previous time series had no correlation between the observations. One way to induce correlation is to create a “moving average” of the observations. This will have an effect of “smoothing” the series.</p>
<p>Let <span class="math inline">\(m_t = \frac{w_t+w_{t-1}+w_{t-2}}{3}\)</span>. This can be done in R using the following code:</p>
</div>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="basic-model.html#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">8128</span>)</span>
<span id="cb88-2"><a href="basic-model.html#cb88-2" aria-hidden="true" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n=</span><span class="dv">100</span>,<span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="dv">1</span>)</span>
<span id="cb88-3"><a href="basic-model.html#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(w)</span>
<span id="cb88-4"><a href="basic-model.html#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -0.10528941  0.25548490  0.82065388  0.04070997</span></span>
<span id="cb88-5"><a href="basic-model.html#cb88-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [5] -0.66722880 -1.54502793</span></span></code></pre></div>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="basic-model.html#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.new</span>(<span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">6</span>, <span class="at">pointsize =</span> <span class="dv">10</span>) <span class="co">#Open a new plot window</span></span>
<span id="cb89-2"><a href="basic-model.html#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> w, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(m[t], <span class="st">&quot; or &quot;</span>, w[t])), <span class="at">xlab =</span> <span class="st">&quot;t&quot;</span>, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb89-3"><a href="basic-model.html#cb89-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.first =</span> <span class="fu">grid</span>(<span class="at">col =</span> <span class="st">&quot;gray&quot;</span>, <span class="at">lty =</span> <span class="st">&quot;dotted&quot;</span>), <span class="at">lty =</span> <span class="st">&quot;dotted&quot;</span>)</span>
<span id="cb89-4"><a href="basic-model.html#cb89-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(<span class="at">x =</span> w, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="basic-model.html#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># rep(1/3,3) repeats 1/3 3 times</span></span>
<span id="cb90-2"><a href="basic-model.html#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="co"># we can use filter() to generate moveing average</span></span>
<span id="cb90-3"><a href="basic-model.html#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="co"># filter() help us build linear combination of elts of w</span></span>
<span id="cb90-4"><a href="basic-model.html#cb90-4" aria-hidden="true" tabindex="-1"></a><span class="co"># filter= linear combination coef</span></span>
<span id="cb90-5"><a href="basic-model.html#cb90-5" aria-hidden="true" tabindex="-1"></a><span class="co"># convolution for moving average</span></span>
<span id="cb90-6"><a href="basic-model.html#cb90-6" aria-hidden="true" tabindex="-1"></a><span class="co"># sides=1，表示只使用輸入向量的左側。</span></span>
<span id="cb90-7"><a href="basic-model.html#cb90-7" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">filter</span>(w, <span class="at">filter =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">3</span>), <span class="at">method=</span><span class="st">&quot;convolution&quot;</span>, <span class="at">sides=</span><span class="dv">1</span>)</span>
<span id="cb90-8"><a href="basic-model.html#cb90-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-9"><a href="basic-model.html#cb90-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(m)</span>
<span id="cb90-10"><a href="basic-model.html#cb90-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1]          NA          NA  0.32361646  0.37228292</span></span>
<span id="cb90-11"><a href="basic-model.html#cb90-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [5]  0.06471168 -0.72384892</span></span>
<span id="cb90-12"><a href="basic-model.html#cb90-12" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(m)</span>
<span id="cb90-13"><a href="basic-model.html#cb90-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1]  0.3158762 -0.1803096  0.2598066 -0.6450531 -0.5879723</span></span>
<span id="cb90-14"><a href="basic-model.html#cb90-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [6] -0.9120182</span></span></code></pre></div>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="basic-model.html#cb91-1" aria-hidden="true" tabindex="-1"></a>(w[<span class="dv">1</span>]<span class="sc">+</span>w[<span class="dv">2</span>]<span class="sc">+</span>w[<span class="dv">3</span>])<span class="sc">/</span><span class="dv">3</span></span>
<span id="cb91-2"><a href="basic-model.html#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.3236165</span></span>
<span id="cb91-3"><a href="basic-model.html#cb91-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-4"><a href="basic-model.html#cb91-4" aria-hidden="true" tabindex="-1"></a>(w[<span class="dv">98</span>]<span class="sc">+</span>w[<span class="dv">99</span>]<span class="sc">+</span>w[<span class="dv">100</span>])<span class="sc">/</span><span class="dv">3</span></span>
<span id="cb91-5"><a href="basic-model.html#cb91-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -0.9120182</span></span></code></pre></div>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="basic-model.html#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> w, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(m[t], <span class="st">&quot; or &quot;</span>, w[t])), </span>
<span id="cb92-2"><a href="basic-model.html#cb92-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;t&quot;</span>, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">panel.first =</span> </span>
<span id="cb92-3"><a href="basic-model.html#cb92-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grid</span>(<span class="at">col =</span> <span class="st">&quot;gray&quot;</span>, <span class="at">lty =</span> <span class="st">&quot;dotted&quot;</span>), <span class="at">lty =</span> <span class="st">&quot;dotted&quot;</span>)</span>
<span id="cb92-4"><a href="basic-model.html#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x =</span> w, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb92-5"><a href="basic-model.html#cb92-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x =</span> m, <span class="at">col =</span> <span class="st">&quot;brown&quot;</span>, <span class="at">lty =</span> <span class="st">&quot;solid&quot;</span>, <span class="at">lwd =</span> <span class="dv">4</span>)</span>
<span id="cb92-6"><a href="basic-model.html#cb92-6" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x =</span> m, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">&quot;orange&quot;</span>)</span>
<span id="cb92-7"><a href="basic-model.html#cb92-7" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="st">&quot;top&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;MA, 3 points&quot;</span>, <span class="st">&quot;White noise&quot;</span>), <span class="at">lty =</span> <span class="fu">c</span>(<span class="st">&quot;solid&quot;</span>, <span class="st">&quot;dotted&quot;</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;brown&quot;</span>, </span>
<span id="cb92-8"><a href="basic-model.html#cb92-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;red&quot;</span>), <span class="at">lwd =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">1</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="03-Basic-Model_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>The plot below shows a 7-point moving average.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="basic-model.html#cb93-1" aria-hidden="true" tabindex="-1"></a>m7 <span class="ot">&lt;-</span> <span class="fu">filter</span>(<span class="at">x=</span>w, <span class="at">filter=</span><span class="fu">rep</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">7</span>, <span class="at">times=</span><span class="dv">7</span>),<span class="at">method=</span><span class="st">&quot;convolution&quot;</span>, <span class="at">sides=</span><span class="dv">1</span>)</span>
<span id="cb93-2"><a href="basic-model.html#cb93-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-3"><a href="basic-model.html#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span>w, <span class="at">ylab=</span><span class="fu">expression</span>(<span class="fu">paste</span>(m[t],<span class="st">&quot;or&quot;</span>,w[t])), <span class="at">xlab=</span><span class="st">&quot;t&quot;</span>,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">panel_filter=</span><span class="fu">grid</span>(<span class="at">col=</span><span class="st">&quot;gray&quot;</span>,<span class="at">lty=</span><span class="st">&quot;dotted&quot;</span>), <span class="at">lty=</span><span class="st">&quot;dotted&quot;</span>)</span>
<span id="cb93-4"><a href="basic-model.html#cb93-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-5"><a href="basic-model.html#cb93-5" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x=</span>w, <span class="at">pch=</span><span class="dv">20</span>, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb93-6"><a href="basic-model.html#cb93-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-7"><a href="basic-model.html#cb93-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x=</span>m, <span class="at">col=</span><span class="st">&quot;brown&quot;</span>, <span class="at">lty=</span><span class="st">&quot;solid&quot;</span>,<span class="at">lwd=</span><span class="dv">4</span>)</span>
<span id="cb93-8"><a href="basic-model.html#cb93-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-9"><a href="basic-model.html#cb93-9" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x=</span>m, <span class="at">pch=</span><span class="dv">20</span>, <span class="at">col=</span><span class="st">&quot;orange&quot;</span>)</span>
<span id="cb93-10"><a href="basic-model.html#cb93-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x =</span> m7, <span class="at">col =</span> <span class="st">&quot;lightgreen&quot;</span>, <span class="at">lty =</span> <span class="st">&quot;solid&quot;</span>, <span class="at">lwd =</span> <span class="dv">4</span>)</span>
<span id="cb93-11"><a href="basic-model.html#cb93-11" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x =</span> m7, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>)</span>
<span id="cb93-12"><a href="basic-model.html#cb93-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-13"><a href="basic-model.html#cb93-13" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="st">&quot;top&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;MA, 3 points&quot;</span>, <span class="st">&quot;White noise&quot;</span>, <span class="st">&quot;MA 7 points&quot;</span>),</span>
<span id="cb93-14"><a href="basic-model.html#cb93-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">lty =</span> <span class="fu">c</span>(<span class="st">&quot;solid&quot;</span>, <span class="st">&quot;dotted&quot;</span>, <span class="st">&quot;solid&quot;</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;brown&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;lightgreen&quot;</span>),</span>
<span id="cb93-15"><a href="basic-model.html#cb93-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">lwd =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">4</span>), <span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="03-Basic-Model_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="autoregression" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Autoregression<a href="basic-model.html#autoregression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="example">
<p><span id="exm:unlabeled-div-4" class="example"><strong>Example 4.3  </strong></span><strong><em>Autoregression</em></strong></p>
<p>An autoregression model uses past observations to predict future observations in a regression model.</p>
<p>Suppose the autoregression model is</p>
<p><span class="math inline">\(x_t = 0.7x_{t-1} + w_t, w_t \sim \mathrm{i.i.d.} N(0,1) ,\forall t = 1, …, n\)</span></p>
<p>Because there is one past period on the right hand side, this is often denoted as an AR(1) model</p>
<p>Obviously, there will be a correlation between the random variables.</p>
</div>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="basic-model.html#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">6381</span>)  <span class="co">#Different seed from white_noise.R</span></span>
<span id="cb94-2"><a href="basic-model.html#cb94-2" aria-hidden="true" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">200</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb94-3"><a href="basic-model.html#cb94-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(w)</span>
<span id="cb94-4"><a href="basic-model.html#cb94-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1]  0.06737166 -0.68095839  0.78930605  0.60049855</span></span>
<span id="cb94-5"><a href="basic-model.html#cb94-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [5] -1.21297680 -1.14082872</span></span></code></pre></div>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="basic-model.html#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Simple way to simulate AR(1) data</span></span>
<span id="cb95-2"><a href="basic-model.html#cb95-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="at">length =</span> <span class="dv">200</span>)</span>
<span id="cb95-3"><a href="basic-model.html#cb95-3" aria-hidden="true" tabindex="-1"></a>x<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb95-4"><a href="basic-model.html#cb95-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x)) {</span>
<span id="cb95-5"><a href="basic-model.html#cb95-5" aria-hidden="true" tabindex="-1"></a>    x[i] <span class="ot">&lt;-</span> <span class="fl">0.7</span><span class="sc">*</span>x<span class="fl">.1</span> <span class="sc">+</span> w[i]</span>
<span id="cb95-6"><a href="basic-model.html#cb95-6" aria-hidden="true" tabindex="-1"></a>    x<span class="fl">.1</span> <span class="ot">&lt;-</span> x[i]</span>
<span id="cb95-7"><a href="basic-model.html#cb95-7" aria-hidden="true" tabindex="-1"></a>  }</span></code></pre></div>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="basic-model.html#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">data.frame</span>(x, w))</span>
<span id="cb96-2"><a href="basic-model.html#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             x           w</span></span>
<span id="cb96-3"><a href="basic-model.html#cb96-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  0.06737166  0.06737166</span></span>
<span id="cb96-4"><a href="basic-model.html#cb96-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 -0.63379823 -0.68095839</span></span>
<span id="cb96-5"><a href="basic-model.html#cb96-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  0.34564730  0.78930605</span></span>
<span id="cb96-6"><a href="basic-model.html#cb96-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  0.84245166  0.60049855</span></span>
<span id="cb96-7"><a href="basic-model.html#cb96-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 -0.62326064 -1.21297680</span></span>
<span id="cb96-8"><a href="basic-model.html#cb96-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 -1.57711117 -1.14082872</span></span></code></pre></div>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="basic-model.html#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Do not use first 100</span></span>
<span id="cb97-2"><a href="basic-model.html#cb97-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> x[<span class="dv">101</span><span class="sc">:</span><span class="dv">200</span>]</span></code></pre></div>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="basic-model.html#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.new</span>(<span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">6</span>, <span class="at">pointsize =</span> <span class="dv">10</span>)  <span class="co">#Opens up wider plot window than the default (good for time series plots)</span></span>
<span id="cb98-2"><a href="basic-model.html#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> x, <span class="at">ylab =</span> <span class="fu">expression</span>(x[t]), <span class="at">xlab =</span> <span class="st">&quot;t&quot;</span>, <span class="at">type =</span> </span>
<span id="cb98-3"><a href="basic-model.html#cb98-3" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>), <span class="at">lwd =</span> <span class="dv">1</span> , <span class="at">main =</span> </span>
<span id="cb98-4"><a href="basic-model.html#cb98-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;AR(1): &quot;</span>, x[t] <span class="sc">==</span> <span class="fl">0.7</span><span class="sc">*</span>x[t<span class="dv">-1</span>] <span class="sc">+</span> </span>
<span id="cb98-5"><a href="basic-model.html#cb98-5" aria-hidden="true" tabindex="-1"></a>      w[t])), <span class="at">panel.first =</span> <span class="fu">grid</span>(<span class="at">col =</span> <span class="st">&quot;gray&quot;</span>, <span class="at">lty =</span> </span>
<span id="cb98-6"><a href="basic-model.html#cb98-6" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;dotted&quot;</span>))</span>
<span id="cb98-7"><a href="basic-model.html#cb98-7" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x =</span> x, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="basic-model.html#cb99-1" aria-hidden="true" tabindex="-1"></a> <span class="co">#Show first few observations after removal of first 100</span></span>
<span id="cb99-2"><a href="basic-model.html#cb99-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="fu">data.frame</span>(<span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, x), w[<span class="dv">99</span><span class="sc">:</span><span class="dv">200</span>]))</span>
<span id="cb99-3"><a href="basic-model.html#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   c.NA..NA..x.  w.99.200.</span></span>
<span id="cb99-4"><a href="basic-model.html#cb99-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1           NA  0.3918531</span></span>
<span id="cb99-5"><a href="basic-model.html#cb99-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2           NA -0.1980565</span></span>
<span id="cb99-6"><a href="basic-model.html#cb99-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3     1.429572  0.7508375</span></span>
<span id="cb99-7"><a href="basic-model.html#cb99-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4    -1.878239 -2.8789389</span></span>
<span id="cb99-8"><a href="basic-model.html#cb99-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5    -1.470250 -0.1554829</span></span>
<span id="cb99-9"><a href="basic-model.html#cb99-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6    -3.464078 -2.4349033</span></span>
<span id="cb99-10"><a href="basic-model.html#cb99-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb99-11"><a href="basic-model.html#cb99-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-12"><a href="basic-model.html#cb99-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Correlation between x_t and x_t-1 </span></span>
<span id="cb99-13"><a href="basic-model.html#cb99-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>(x[<span class="dv">2</span><span class="sc">:</span><span class="dv">100</span>], x[<span class="dv">1</span><span class="sc">:</span><span class="dv">99</span>])</span>
<span id="cb99-14"><a href="basic-model.html#cb99-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.7270483</span></span></code></pre></div>
<p>Here is an easier way to simulate observations from an AR(1). Note that this uses an Autoregressive Integrated Moving Average (ARIMA) structure that we will discuss later in the course. In this case, I use <span class="math inline">\(\sigma_w\)</span>= 10.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="basic-model.html#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7181</span>)</span>
<span id="cb100-2"><a href="basic-model.html#cb100-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">arima.sim</span>(<span class="at">model =</span> <span class="fu">list</span>(<span class="at">ar =</span> <span class="fu">c</span>(<span class="fl">0.7</span>)), <span class="at">n =</span> <span class="dv">100</span>, </span>
<span id="cb100-3"><a href="basic-model.html#cb100-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">rand.gen =</span> rnorm, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb100-4"><a href="basic-model.html#cb100-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> x, <span class="at">ylab =</span> <span class="fu">expression</span>(x[t]), <span class="at">xlab =</span> <span class="st">&quot;t&quot;</span>, <span class="at">type =</span> </span>
<span id="cb100-5"><a href="basic-model.html#cb100-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">1</span> ,<span class="at">main =</span> </span>
<span id="cb100-6"><a href="basic-model.html#cb100-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;AR(1): &quot;</span>, x[t] <span class="sc">==</span> <span class="fl">0.7</span><span class="sc">*</span>x[t<span class="dv">-1</span>] <span class="sc">+</span> </span>
<span id="cb100-7"><a href="basic-model.html#cb100-7" aria-hidden="true" tabindex="-1"></a>    w[t])), <span class="at">panel.first=</span><span class="fu">grid</span>(<span class="at">col =</span> <span class="st">&quot;gray&quot;</span>, <span class="at">lty =</span> </span>
<span id="cb100-8"><a href="basic-model.html#cb100-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;dotted&quot;</span>))</span>
<span id="cb100-9"><a href="basic-model.html#cb100-9" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x =</span> x, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="03-Basic-Model_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="plotting.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="dependence.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Time-Series-Analysis.pdf", "Time-Series-Analysis.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
},
"repo": "https://github.com/shang-chieh0830/Time-Series-Analysis"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
